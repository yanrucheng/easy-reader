<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>易读器</title>
  <style>
    :root {
      color-scheme: light dark;
      --bg: #ffffff;
      --fg: #111111;
      --border: #e5e7eb;
      --muted: #6b7280;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #0b0e13;
        --fg: #e5e7eb;
        --border: #202633;
        --muted: #9aa3b2;
      }
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      padding: 24px;
      background: var(--bg);
      color: var(--fg);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
    }
    main { max-width: 1100px; margin: 0 auto; }
    h1 { font-size: 24px; margin: 0 0 6px; }
    .subtitle { color: var(--muted); margin: 0 0 20px; font-size: 14px; }
    .container { display: flex; gap: 16px; align-items: stretch; }
    .column { flex: 1; display: flex; flex-direction: column; min-width: 0; }
    label { font-weight: 600; margin-bottom: 8px; }
    .toolbar { display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; }
    .copy-btn {
      padding: 4px 8px;
      border: 1px solid var(--border);
      background: rgba(0, 0, 0, 0.05);
      backdrop-filter: blur(4px);
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      color: inherit;
      position: absolute;
      top: 12px;
      right: 12px;
      z-index: 10;
      opacity: 0.8;
    }

    .copy-btn:hover {
      opacity: 1;
      filter: brightness(1.05);
    }
    textarea {
      flex: 1;
      width: 100%;
      min-height: 320px;
      padding: 28px 12px 12px 12px;
      border: none;
      border-radius: 10px;
      background: transparent;
      color: inherit;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
      line-height: 1.7;
      font-size: 16px;
      resize: vertical;
      outline: none;
      overflow: auto;
    }
    textarea[readonly] { background: transparent; }
    .input-container,
    .output {
      flex: 1;
      width: 100%;
      min-height: 320px;
      padding: 0;
      border: 1px solid var(--border);
      border-radius: 10px;
      background: transparent;
      position: relative;
      display: flex;
      flex-direction: column;
    }

    .output-content {
      flex: 1;
      padding: 28px 12px 12px 12px;
      overflow: auto;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
      line-height: 1.7;
      font-size: 16px;
    }

    .help { color: var(--muted); font-size: 12px; margin-top: 8px; }
    .hl { background: #fde68a; color: inherit; padding: 0 2px; border-radius: 3px; }
    .hl-red { background: #fecaca; color: inherit; padding: 0 2px; border-radius: 3px; }
    .hl-purple { background: #eed2ee; color: inherit; padding: 0 2px; border-radius: 3px; }
    .hl-green { background: #bbf7d0; color: inherit; padding: 0 2px; border-radius: 3px; }
    .hl-lightgreen { background: #d1fae5; color: inherit; padding: 0 2px; border-radius: 3px; }
    @media (prefers-color-scheme: dark) {
      .hl { background: #7a5d00; }
      .hl-red { background: #7c2d12; }
      .hl-purple { background: #581c87; }
      .hl-green { background: #15803d; }
      .hl-lightgreen { background: #22543d; }
    }
    @media (max-width: 860px) { .container { flex-direction: column; } }
  </style>
</head>
<body>
  <main>
    <h1>易读器</h1>
    <p class="subtitle">将罕见汉字替换为读音，便于朗读与理解。</p>
    <div style="margin-bottom: 16px;">
      <label for="topKSlider" style="display: block; margin-bottom: 8px; font-weight: 600;">
        常用字范围: <span id="topKValue">2500</span> 字
      </label>
      <input type="range" id="topKSlider" min="100" max="5000" value="2500" step="100" style="width: 100%; max-width: 400px;">
      <p class="help" style="margin-top: 4px;">仅替换前2500个最常用字之外的汉字为常见字</p>

      <div style="margin-top: 12px; display: flex; align-items: center; gap: 8px;">
        <label for="toneSwitch" style="font-weight: 600; font-size: 14px;">允许不同声调替换</label>
        <input type="checkbox" id="toneSwitch" checked>
      </div>
      <p class="help" style="margin-top: 4px;">如果勾选，当同声调常用字不存在时，将使用不同声调的常用字（紫色标记）</p>

      <div style="margin-top: 12px; display: flex; align-items: center; gap: 8px;">
        <label for="highlightMultiPronunciation" style="font-weight: 600; font-size: 14px;">标记多音字为绿色</label>
        <input type="checkbox" id="highlightMultiPronunciation">
      </div>
      <p class="help" style="margin-top: 4px;">如果勾选，将把有多种读音的汉字标记为绿色，便于识别多音字</p>
    </div>
    <div class="container">
      <div class="column">
        <label for="input">原文输入</label>
        <div id="inputContainer" class="input-container">
          <textarea id="input" placeholder="在此粘贴或输入文本…"></textarea>
          <button id="inputCopyBtn" class="copy-btn input-copy-btn" type="button">复制</button>
        </div>
        <p class="help">在此粘贴或输入文本，系统将自动转换为易读格式。</p>
      </div>
      <div class="column">
        <label for="output">易读转换（仅查看与复制）</label>
        <div id="output" class="output" aria-label="易读转换结果" tabindex="0">
          <div id="outputContent" class="output-content"></div>
          <button id="copyBtn" class="copy-btn" type="button">复制</button>
        </div>
        <p class="help">此窗口仅用于查看与复制，不支持输入或粘贴。</p>
      </div>
    </div>
    <div style="margin-top: 24px; padding: 12px; border: 1px solid var(--border); border-radius: 10px; background: rgba(0, 0, 0, 0.03);">
      <p style="margin: 0 0 8px; font-weight: 600; font-size: 14px;">颜色说明：</p>
      <ul style="margin: 0; padding-left: 16px; font-size: 14px; color: var(--muted);">
        <li style="margin-bottom: 4px;"><mark class="hl">黄色高亮</mark>：替换为同声调的常用字（在所选常用字范围内）</li>
        <li style="margin-bottom: 4px;"><mark class="hl-purple">紫色高亮</mark>：替换为不同声调的常用字（在所选常用字范围内）</li>
        <li style="margin-bottom: 4px;"><mark class="hl-red">红色高亮</mark>：替换为读音相同但不常用的字或无合适替换</li>
        <li style="margin-bottom: 4px;"><mark class="hl-lightgreen">浅绿色高亮</mark>：表示该常用汉字（前300字）有多种读音（多音字）</li>
        <li style="margin-bottom: 4px;"><mark class="hl-green">绿色高亮</mark>：表示该汉字有多种读音（多音字）</li>
      </ul>
    </div>
  </main>
  <script type="module" src="/src/main.ts"></script>
</body>
</html>